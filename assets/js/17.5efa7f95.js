(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{343:function(t,s,a){"use strict";a.r(s);var n=a(7),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h3",{attrs:{id:"环境初始化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#环境初始化"}},[t._v("#")]),t._v(" 环境初始化")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("首先建立项目文件夹，进入文件夹，使用 shift+鼠标右键，选择[在此处打开PowerShell窗口]。")])]),t._v(" "),s("li",[s("p",[t._v("建立服务端项目文件夹:")]),t._v(" "),s("div",{staticClass:"language-Shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" server_user\n")])])])]),t._v(" "),s("li",[s("p",[t._v("创建并启动虚拟环境:")]),t._v(" "),s("div",{staticClass:"language-Shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("python "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-m")]),t._v(" virtualenv tddFlask\n."),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("/tddFlask/Scripts/activate\n")])])])]),t._v(" "),s("li",[s("p",[t._v("安装Flask：")]),t._v(" "),s("div",{staticClass:"language-Shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("pip "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" Flask\n")])])])])]),t._v(" "),s("blockquote",[s("p",[t._v("说明:\n如果出现："),s("code",[t._v("[notice] A new release of pip is available:...")]),t._v("字样提示，说明pip install版本不是最新。\n可以执行："),s("code",[t._v("python.exe -m pip install --upgrade pip")]),t._v(" 升级")])]),t._v(" "),s("h3",{attrs:{id:"添加路由"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#添加路由"}},[t._v("#")]),t._v(" 添加路由")]),t._v(" "),s("p",[t._v("使用VsCode打开server_user文件夹，在根目录下新建__init__.py文件")]),t._v(" "),s("div",{staticClass:"language-Python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" flask "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Flask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("jsonify\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#App初始化")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Flask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__name__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/startInfo'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("methods"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'GET'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start_info")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" jsonify"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'code'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'000000000000'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'message'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'OK'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("安装Flask-Script包，用于使用命令行来管理Flask")]),t._v(" "),s("div",{staticClass:"language-Shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("pip "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" Flask-Script\n")])])]),s("p",[t._v("使用vscode，在server_user目录下新增:main.py文件：")]),t._v(" "),s("div",{staticClass:"language-Python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" flask_script "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Manager\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" __init__ "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" app\n\nmanager "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Manager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" __name__ "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'__main__'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    manager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("run"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("在PowerShell中使用命令行启动:")]),t._v(" "),s("div",{staticClass:"language-Shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("python main.py runserver\n")])])]),s("blockquote",[s("p",[t._v("此时如果出现"),s("code",[t._v("No module named 'flask._compat'")]),t._v("错误，说明flask_script版本可能过高。\n此时可以减配，也可以到 /tddFlask/Lib/site-packages/flask_script/ 目录下的 "),s("strong",[t._v("init")]),t._v(".py 文件第15行\n将 "),s("code",[t._v("from flask._compat import text_type")]),t._v("改为 "),s("code",[t._v("from flask_script._compat import text_type")]),t._v("即可.")])]),t._v(" "),s("p",[t._v("在浏览器中打开 "),s("a",{attrs:{href:"http://127.0.0.1:5000/startInfo",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://127.0.0.1:5000/startInfo"),s("OutboundLink")],1),t._v("，即可看到页面输出信息：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v('{"code":"000000000000","message":"OK"}\n')])])]),s("h3",{attrs:{id:"配置启动设置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置启动设置"}},[t._v("#")]),t._v(" 配置启动设置")]),t._v(" "),s("p",[t._v("根目录下使用VSCode添加文件：config.py:")]),t._v(" "),s("div",{staticClass:"language-Python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("BaseConfig")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""基础配置"""')]),t._v("\n    DEBUG"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("\n    TESTING"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("DevConfig")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("BaseConfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""开发环境配置"""')]),t._v("\n    DEBUG"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TestConfig")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("BaseConfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""测试环境配置"""')]),t._v("\n    DEBUG"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n    TESTING"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ProdConfig")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("BaseConfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token triple-quoted-string string"}},[t._v('"""生产环境配置"""')]),t._v("\n    DEBUG"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("False")]),t._v("\n")])])]),s("p",[t._v("修改__init__.py文件：")]),t._v(" "),s("div",{staticClass:"language-Python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# server/__init__.py")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" flask "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" Flask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("jsonify\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" config "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" DevConfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("TestConfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("ProdConfig\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#App初始化")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Flask"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("__name__"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#环境配置")]),t._v("\ncurrConfig"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("DevConfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\napp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("from_object"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("currConfig"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#路由设置")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token decorator annotation punctuation"}},[t._v("@app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("route")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/startInfo'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("methods"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'GET'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("def")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("start_info")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" jsonify"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'code'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'000000000000'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'message'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'OK'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("重新启动：")]),t._v(" "),s("div",{staticClass:"language-Shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("python main.py runserver\n")])])]),s("p",[t._v("此时出现")]),t._v(" "),s("p",[t._v("'''Shell\nDebug mode: on\n'''")]),t._v(" "),s("p",[t._v("字样提示，标志Debug模式已经打开。此时任何代码改动将即时地进行加载，不必再重新启动Flask。")]),t._v(" "),s("h3",{attrs:{id:"保证依赖同步"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#保证依赖同步"}},[t._v("#")]),t._v(" 保证依赖同步")]),t._v(" "),s("p",[t._v("为了保证我们的项目依赖实时同步，我们将依赖包添加到一个名为 requirements.txt 的文件中")]),t._v(" "),s("div",{staticClass:"language-Shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("pip freeze "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" requirements.txt\n")])])]),s("p",[t._v("查看 requirements.txt 文件的内容")]),t._v(" "),s("div",{staticClass:"language-txt extra-class"},[s("pre",{pre:!0,attrs:{class:"language-txt"}},[s("code",[t._v("autopep8==2.0.2\nclick==8.1.3\ncolorama==0.4.6\nFlask==2.2.3\nFlask-Script==2.0.6\nitsdangerous==2.1.2\nJinja2==3.1.2\nMarkupSafe==2.1.2\npycodestyle==2.10.0\nWerkzeug==2.2.3\n")])])]),s("p",[t._v("配置完毕，可以退出虚拟环境：")]),t._v(" "),s("div",{staticClass:"language-Shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("deactivate\n")])])]),s("h3",{attrs:{id:"git提交"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#git提交"}},[t._v("#")]),t._v(" GIT提交")]),t._v(" "),s("p",[t._v("为提交Git，项目根目录下新增 .gitignore 文件：")]),t._v(" "),s("div",{staticClass:"language-git extra-class"},[s("pre",{pre:!0,attrs:{class:"language-git"}},[s("code",[t._v("__pycache__\nenv\n")])])]),s("p",[t._v("根目录下初始化Git：")]),t._v(" "),s("div",{staticClass:"language-GIT extra-class"},[s("pre",{pre:!0,attrs:{class:"language-git"}},[s("code",[t._v("git init\n")])])]),s("p",[t._v("添加文件:")]),t._v(" "),s("div",{staticClass:"language-Git extra-class"},[s("pre",{pre:!0,attrs:{class:"language-git"}},[s("code",[t._v("git add .\n")])])]),s("p",[t._v("提交并推送至github:")]),t._v(" "),s("div",{staticClass:"language-Git extra-class"},[s("pre",{pre:!0,attrs:{class:"language-git"}},[s("code",[t._v("git commit -m "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Flask微服务项目 初始化提交'")]),t._v("\ngit push ...\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);